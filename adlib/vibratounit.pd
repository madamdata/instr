#N canvas 198 247 973 462 10;
#N canvas 1 53 450 300 writer 0;
#X obj 158 77 inlet~;
#X obj 166 211 outlet~;
#X obj 158 99 delwrite~ \$0-delay 400;
#X connect 0 0 2 0;
#X restore 152 132 pd writer;
#N canvas 1 53 450 300 reader 0;
#X obj 126 75 inlet~;
#X obj 166 160 delread4~ \$0-delay;
#X obj 280 79 inlet~ deltime;
#X obj 138 211 outlet~;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X restore 154 209 pd reader;
#X obj 200 294 *~;
#X obj 258 294 *~;
#N canvas 1 53 450 300 reader 0;
#X obj 126 75 inlet~;
#X obj 166 160 delread4~ \$0-delay;
#X obj 280 79 inlet~ deltime;
#X obj 138 211 outlet~;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X restore 241 207 pd reader;
#N canvas 1 53 693 313 calculatefreq 0;
#X obj 17 104 expr pow(2 \, ($f1/12));
#X obj 17 64 inlet semitones;
#X obj 17 244 outlet frequency;
#X obj 186 15 inlet maxdelay;
#X obj 174 68 t b f;
#X obj 17 216 expr (1-$f1)/$f2;
#X obj 206 150 / 1000;
#X text 220 107 <- calculates the playback ratio \, which is 2 to the
power of (number of semitones /12);
#X text 142 218 <- phasor frequency is (1 - ratio) / max delay;
#X connect 0 0 5 0;
#X connect 1 0 0 0;
#X connect 3 0 4 0;
#X connect 4 0 0 0;
#X connect 4 1 6 0;
#X connect 5 0 2 0;
#X connect 6 0 5 1;
#X restore 329 105 pd calculatefreq;
#N canvas 592 109 767 400 phasors 0;
#X obj 126 88 phasor~;
#X obj 36 187 *~ 40;
#X obj 282 177 /~ 2;
#X obj 282 199 -~ 0.25;
#X obj 282 221 cos~;
#X obj 249 94 +~ 0.5;
#X obj 249 116 wrap~;
#X obj 413 168 /~ 2;
#X obj 413 190 -~ 0.25;
#X obj 413 212 cos~;
#X obj 155 191 *~ 40;
#X obj 124 13 inlet frequency;
#X text 305 94 generate overlapping phasor;
#X obj 35 250 outlet~ phase1;
#X obj 154 250 outlet~ phase2;
#X obj 284 251 outlet~ window1;
#X obj 413 254 outlet~ window2;
#X obj 426 39 inlet maxdelay;
#X text 486 191 generate cosine windows;
#X obj 288 23 inlet~ mod;
#X obj 125 34 sig~;
#X floatatom 46 36 5 0 0 0 - - -, f 5;
#X obj 122 57 +~;
#X connect 0 0 1 0;
#X connect 0 0 2 0;
#X connect 0 0 5 0;
#X connect 1 0 13 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 4 0 15 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 6 0 10 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 16 0;
#X connect 10 0 14 0;
#X connect 11 0 20 0;
#X connect 11 0 21 0;
#X connect 17 0 10 1;
#X connect 17 0 1 1;
#X connect 19 0 22 1;
#X connect 20 0 22 0;
#X connect 22 0 0 0;
#X restore 328 150 pd phasors;
#X obj 168 47 inlet~;
#X obj 220 370 outlet~;
#X obj 846 145 inlet switch;
#X obj 513 185 switch~;
#X text 35 143 dummy connection to ensure correct order of execution
, f 13;
#X obj 313 -3 initbang;
#X msg 334 64 0;
#X obj 313 19 t b b;
#X msg 514 134 1;
#X obj 370 240 tanh~;
#X obj 412 240 tanh~;
#X obj 411 197 *~ 3;
#X obj 361 191 *~ 3;
#X text 314 44 semitones;
#X text 401 35 maxdelay;
#X obj 506 46 inlet~ mod;
#X msg 400 61 75;
#X connect 0 0 1 0;
#X connect 0 0 4 0;
#X connect 1 0 2 0;
#X connect 2 0 8 0;
#X connect 3 0 8 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 1 1;
#X connect 6 1 4 1;
#X connect 6 2 19 0;
#X connect 6 3 18 0;
#X connect 7 0 0 0;
#X connect 9 0 10 0;
#X connect 12 0 14 0;
#X connect 13 0 5 0;
#X connect 14 0 13 0;
#X connect 14 0 15 0;
#X connect 14 1 23 0;
#X connect 15 0 10 0;
#X connect 16 0 2 1;
#X connect 17 0 3 1;
#X connect 18 0 17 0;
#X connect 19 0 16 0;
#X connect 22 0 6 1;
#X connect 23 0 6 2;
#X connect 23 0 5 1;
